<!DOCTYPE html>
<html>
    <header style="position: relative;">        
        <style>
/* 1. Reset default browser margins/paddings */
            html, body {
                margin: 0;
                padding: 0;
                width: 100%;
                height: 100%;
                overflow: hidden; /* Prevents scrollbars */
                
                /* **NEW: Enable Flexbox on the body** */
                display: flex;
                flex-direction: column;

                /* For the background */
                background-image: url("BG.jpg");
                background-size: cover;
            }
            
            /* 2. Header elements take their natural height (flex-shrink: 0) */
            header {
                padding: 10px; /* Add some padding for visual separation */
                flex-shrink: 0; 
            }
            
            /* 3. The canvas wrapper takes ALL remaining space (flex-grow: 1) */
            #canvas-area-wrapper {
                flex-grow: 1; /* Takes all remaining vertical space */
                width: 100%; 
                height: 100%; 
                
                /* **NEW: Use Flexbox to center the canvas inside this area** */
                display: flex;
                justify-content: center; /* Center horizontally */
                align-items: center; /* Center vertically */
            }
            
            /* 4. The canvas itself will be sized by JavaScript to be a square */
            #canvas {
                display: block;
                border-left: 2px solid black;
                border-bottom: 2px solid black;
                border-right: 2px solid black;
                /* The actual square dimensions will be set in the JS */
            }
        </style>
        <h1 style="text-align: center; margin: 0%;">Coin Grabber</h1>
        <h3 style="text-align: center; margin: 0%;">Multiplayer Server Tests</h3>
        <div style="display: block; float: left">
            <div>
                <label>Color:</label>
                <input id="ColorPicker" type="color">
            </div>
            <div>
                <label>User ID:</label><label id="UserID"></label>
            </div>
            <div>
                <label>Username:</label><input type="text" id="username"></label>
            </div>
        </div>        
        <div style="display: block; float: right; text-align: center; font-size: 2vw;">
            <div>Collect coins to add to your score!</div>
            <div>Press <b>A</b> and <b>D</b> to move left and right, and press <b>SPACE</b> to jump</div>
            <div>This game uses online multiplayer! Try it with a friend!</div>
        </div>
    </header>
    <body>
        <div id="canvas-area-wrapper">
            <canvas id="canvas"></canvas>
        </div>
        <script>
            const api_url = "http://3.16.54.54:8080/";

            const canvas = document.getElementById('canvas');
            const canvas_wrapper = document.getElementById('canvas-area-wrapper');
            const ctx = canvas.getContext("2d");
            // Function to resize canvas drawing buffer and calculate scale
            function resizeCanvas() {
                // // Set the internal canvas drawing buffer size to match the CSS size
                // // canvas.clientWidth/Height gives the actual pixel size the element is displayed at.
                // canvas.width = canvas.clientWidth;
                // canvas.height = canvas.clientHeight;
                // Get the dimensions of the available drawing area (viewport size)
                const viewportWidth = canvas_wrapper.clientWidth;
                const viewportHeight = canvas_wrapper.clientHeight;

                // Determine the limiting dimension (the smaller of the two)
                const squareSize = Math.min(viewportWidth, viewportHeight);

                // 1. Set the CSS (display) size of the canvas to be a square
                //    This makes the canvas look square on the screen.
                canvas.style.width = `${squareSize}px`;
                canvas.style.height = `${squareSize}px`;

                // 2. Set the internal canvas drawing buffer size (resolution)
                //    This ensures the canvas content is not stretched.
                canvas.width = squareSize;
                canvas.height = squareSize;
            }
            // Call the resize function once on load and add a listener for future resizing
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);
        </script>     
        <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/6.0.1/signalr.js"></script>
        <script src="Utils.js"></script>
        <script src="Input.js"></script>
        <script src="PlayerLogic.js"></script>
        <script src="CoinLogic.js"></script>
        <script src="Renderer.js"></script>
        <script>
            window.requestAnimationFrame(main);
            function main()
            {
                player_main();
                coin_main();
                Render();
                window.requestAnimationFrame(main);
            }
        </script>
    </body>
</html>